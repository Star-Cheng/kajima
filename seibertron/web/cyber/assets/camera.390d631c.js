import{v as y}from"./element-plus.e290ba2a.js";import{M as t}from"./mpegts.js.730ccbc0.js";import{_ as E}from"./interceptors.90732d07.js";import{a3 as w,d as a,i as R,n as d,D as h,R as g,o as b,c as T,a as k}from"./@vue.4c12bbe2.js";import{h as S}from"./index.bf5881c5.js";const D={__name:"FlvVideo2",props:{videoId:{default:"video",type:String},url:{default:"",type:String},isPlay:{default:!0,type:Boolean}},emits:["playerror","startPlay"],setup(r,{emit:u}){const c=r,{videoId:F,url:v,isPlay:M}=w(c),n=a(),s=a(!1),e=a(null);a(null);const f=()=>{s.value=!0,e.value=t.createPlayer({type:"flv",isLive:!0,hasAudio:!1,hasVideo:!0,autoplay:!0,url:v.value},{enableWorker:!0,enableStashBuffer:!1,stashInitialSize:128,liveBufferLatencyChasing:!0}),e.value.attachMediaElement(n.value),e.value.load()},m=()=>{!e.value||(e.value.pause(),e.value.unload(),e.value.destroy(),e.value=null)};R(()=>{f(),d(()=>{e.value.play(),e.value.on(t.Events.MEDIA_INFO,l=>{s.value=!1,u("startPlay")}),e.value.on(t.Events.ERROR,(l,o)=>{l==t.ErrorTypes.MEDIA_ERROR&&o==t.ErrorDetails.MEDIA_FORMAT_UNSUPPORTED,l==t.ErrorTypes.NETWORK_ERROR&&o==t.ErrorDetails.NETWORK_STATUS_CODE_INVALID,l==t.ErrorTypes.OTHER_ERROR,u("playerror")}),n.value.addEventListener("progress",()=>{d(()=>{let o=e.value.buffered.end(0)-e.value.currentTime;if(o>3||o<0){e.value.currentTime=e.value.buffered.end(0)-1;return}o>1?e.value.playbackRate=1.2:e.value.playbackRate=1})}),window.onfocus=()=>{if(e.value){let l=e.value.buffered.end(0)-1;e.value.currentTime=l}}})}),h(()=>{m()});const i=a(null),p=()=>{const l=i.value;if(window.document.fullscreenElement){const o=window.document.exitFullscreen||window.document.msExitFullscreen||window.document.mozCancelFullScreen||window.document.webkitCancelFullScreen;o&&o.call(window.document)}else{const o=l.requestFullScreen||l.webkitRequestFullScreen||l.mozRequestFullScreen;o&&o.call(l)}};return(l,o)=>{const _=y;return g((b(),T("div",{ref_key:"videoComponent",ref:i,style:{width:"100%",height:"100%"},onDblclick:o[0]||(o[0]=O=>p()),class:"video","element-loading-background":"rgba(36, 42, 47, 0.5)"},[k("video",{id:"jswebrtc-video-draw",ref_key:"videoEl",ref:n,preload:"auto",style:{width:"100%",height:"100%","object-fit":"fill"},muted:""},"Your browser is too old which doesn't support HTML5 video.",512)],32)),[[_,s.value]])}}};var B=E(D,[["__scopeId","data-v-124288e9"]]);function q(r){return S.request({url:"/hms/camera/move",method:"GET",params:r})}export{q as c,B as f};
